<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAST Test Cases - Vulnerable Code Examples</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }
        .vulnerability { background: #ffe6e6; padding: 20px; margin: 15px 0; border-left: 5px solid #ff0000; }
        .safe { background: #e6ffe6; padding: 20px; margin: 15px 0; border-left: 5px solid #00ff00; }
        .code { background: #f4f4f4; padding: 15px; margin: 10px 0; border-radius: 5px; font-family: monospace; white-space: pre-wrap; }
        .payload { background: #fff3cd; padding: 10px; margin: 10px 0; border-left: 3px solid #ffc107; }
        h1 { color: #333; text-align: center; }
        h2 { color: #d32f2f; }
        h3 { color: #1976d2; }
        .warning { background: #ffebee; padding: 15px; border: 2px solid #f44336; border-radius: 5px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîì SAST Test Cases - Vulnerable Code Examples</h1>
        
        <div class="warning">
            <h3>‚ö†Ô∏è WARNING</h3>
            <p><strong>These are intentional security vulnerabilities for testing purposes only!</strong></p>
            <p>DO NOT use any of these code patterns in production environments!</p>
        </div>

        <h2>1. SQL Injection Vulnerabilities</h2>
        
        <div class="vulnerability">
            <h3>‚ùå Vulnerable Python Code</h3>
            <div class="code"># VULNERABLE: Direct string concatenation
username = request.form['username']
password = request.form['password']
query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'"
cursor.execute(query)</div>
            
            <div class="payload">
                <strong>Test Payloads:</strong><br>
                Username: <code>admin' OR '1'='1' --</code><br>
                Password: <code>anything</code><br><br>
                Username: <code>admin'; DROP TABLE users; --</code><br>
                Password: <code>anything</code>
            </div>
        </div>

        <div class="safe">
            <h3>‚úÖ Safe Python Code</h3>
            <div class="code"># SAFE: Parameterized query
username = request.form['username']
password = request.form['password']
query = "SELECT * FROM users WHERE username = ? AND password = ?"
cursor.execute(query, (username, password))</div>
        </div>

        <h2>2. Cross-Site Scripting (XSS) Vulnerabilities</h2>
        
        <div class="vulnerability">
            <h3>‚ùå Vulnerable Python Code</h3>
            <div class="code"># VULNERABLE: Direct output without escaping
comment = request.form['comment']
return f"<p>Your comment: {comment}</p>"</div>
            
            <div class="payload">
                <strong>Test Payloads:</strong><br>
                <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code><br>
                <code>&lt;img src=x onerror=alert('XSS')&gt;</code><br>
                <code>&lt;iframe src="javascript:alert('XSS')"&gt;&lt;/iframe&gt;</code>
            </div>
        </div>

        <div class="safe">
            <h3>‚úÖ Safe Python Code</h3>
            <div class="code"># SAFE: Proper escaping
from markupsafe import escape
comment = request.form['comment']
return f"<p>Your comment: {escape(comment)}</p>"</div>
        </div>

        <h2>3. Command Injection Vulnerabilities</h2>
        
        <div class="vulnerability">
            <h3>‚ùå Vulnerable Python Code</h3>
            <div class="code"># VULNERABLE: Direct command execution
host = request.form['host']
result = subprocess.run(f"ping -c 4 {host}", shell=True)</div>
            
            <div class="payload">
                <strong>Test Payloads:</strong><br>
                <code>127.0.0.1; ls -la</code><br>
                <code>127.0.0.1 && cat /etc/passwd</code><br>
                <code>127.0.0.1 | whoami</code>
            </div>
        </div>

        <div class="safe">
            <h3>‚úÖ Safe Python Code</h3>
            <div class="code"># SAFE: Using subprocess with list arguments
host = request.form['host']
# Validate host input first
if not re.match(r'^[a-zA-Z0-9.-]+$', host):
    return "Invalid host"
result = subprocess.run(['ping', '-c', '4', host])</div>
        </div>

        <h2>4. Path Traversal Vulnerabilities</h2>
        
        <div class="vulnerability">
            <h3>‚ùå Vulnerable Python Code</h3>
            <div class="code"># VULNERABLE: Direct file access
filename = request.args.get('filename')
with open(filename, 'r') as f:
    content = f.read()</div>
            
            <div class="payload">
                <strong>Test Payloads:</strong><br>
                <code>../../../etc/passwd</code><br>
                <code>..\\..\\..\\windows\\system32\\drivers\\etc\\hosts</code><br>
                <code>....//....//....//etc/passwd</code>
            </div>
        </div>

        <div class="safe">
            <h3>‚úÖ Safe Python Code</h3>
            <div class="code"># SAFE: Path validation
import os
filename = request.args.get('filename')
# Validate filename
if '..' in filename or filename.startswith('/'):
    return "Invalid filename"
safe_path = os.path.join('/safe/directory', filename)
if not os.path.exists(safe_path):
    return "File not found"
with open(safe_path, 'r') as f:
    content = f.read()</div>
        </div>

        <h2>5. Additional Test Cases</h2>
        
        <div class="vulnerability">
            <h3>‚ùå Vulnerable Java Code</h3>
            <div class="code">// VULNERABLE: String concatenation in Java
String userInput = request.getParameter("user");
String query = "SELECT * FROM users WHERE name = '" + userInput + "'";
Statement stmt = connection.createStatement();
ResultSet rs = stmt.executeQuery(query);</div>
        </div>

        <div class="vulnerability">
            <h3>‚ùå Vulnerable PHP Code</h3>
            <div class="code">// VULNERABLE: Direct inclusion
$page = $_GET['page'];
include($page . '.php');</div>
        </div>

        <div class="vulnerability">
            <h3>‚ùå Vulnerable JavaScript Code</h3>
            <div class="code">// VULNERABLE: eval() usage
var userInput = document.getElementById('input').value;
eval(userInput);</div>
        </div>

        <h2>6. How to Test Your SAST Model</h2>
        
        <div class="safe">
            <h3>Testing Steps:</h3>
            <ol>
                <li><strong>Run the vulnerable website:</strong><br>
                    <code>python github/test_vulnerable_website.py</code></li>
                <li><strong>Access the website:</strong><br>
                    <code>http://localhost:5000</code></li>
                <li><strong>Test each vulnerability:</strong><br>
                    Use the provided payloads to trigger vulnerabilities</li>
                <li><strong>Run your SAST model:</strong><br>
                    <code>python github/SAST/advanced_sast_with_remediation.py</code></li>
                <li><strong>Analyze the results:</strong><br>
                    Check if your model detects the vulnerabilities correctly</li>
            </ol>
        </div>

        <h2>7. Expected SAST Detection Results</h2>
        
        <div class="safe">
            <h3>Your SAST model should detect:</h3>
            <ul>
                <li>‚úÖ SQL injection patterns (string concatenation in queries)</li>
                <li>‚úÖ XSS patterns (unescaped user input in HTML output)</li>
                <li>‚úÖ Command injection patterns (shell=True, string concatenation)</li>
                <li>‚úÖ Path traversal patterns (unsafe file access)</li>
                <li>‚úÖ Unsafe eval() usage</li>
                <li>‚úÖ Unsafe include/require patterns</li>
            </ul>
        </div>

        <div class="warning">
            <h3>üîí Security Reminder</h3>
            <p>After testing, make sure to:</p>
            <ul>
                <li>Stop the vulnerable website server</li>
                <li>Delete any test files created</li>
                <li>Never deploy vulnerable code to production</li>
                <li>Use the safe code patterns in real applications</li>
            </ul>
        </div>
    </div>
</body>
</html>
